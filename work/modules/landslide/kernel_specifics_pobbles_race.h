/**
 * @file kernel_specifics_pobbles_race.h
 * @brief #defines for the pobbles_race guest kernel (automatically generated)
 * @author Ben Blum <bblum@andrew.cmu.edu>
 */

#ifndef __LS_KERNEL_SPECIFICS_POBBLES_RACE_H
#define __LS_KERNEL_SPECIFICS_POBBLES_RACE_H

#define GUEST_CURRENT_TCB 0x00159400
#define GUEST_TCB_TID_OFFSET 0
#define TID_FROM_TCB(cpu, tcb) \
	SIM_read_phys_memory(cpu, tcb + GUEST_TCB_TID_OFFSET, WORD_SIZE)
#define GUEST_TCB_STACK_OFFSET 7
#define STACK_FROM_TCB(tcb) ((tcb)+(GUEST_TCB_STACK_OFFSET*WORD_SIZE))
#define GUEST_STACK_SIZE 4096

#define GUEST_PCB_PID_OFFSET 0
#define PID_FROM_PCB(cpu, pcb) \
	SIM_read_phys_memory(cpu, pcb + GUEST_PCB_PID_OFFSET, WORD_SIZE)
#define GUEST_RQ_ADDR 0x00159404

#define GUEST_Q_ADD                0x00105695
#define GUEST_Q_ADD_Q_ARGNUM       1
#define GUEST_Q_ADD_TCB_ARGNUM     2
#define GUEST_Q_REMOVE             0x00105757
#define GUEST_Q_REMOVE_Q_ARGNUM    1
#define GUEST_Q_REMOVE_TCB_ARGNUM  2
#define GUEST_Q_POP_RETURN         0x105756
#define GUEST_Q_POP_Q_ARGNUM       1

#define GUEST_TIMER_WRAP_ENTER     0x001035bc
#define GUEST_TIMER_WRAP_EXIT      0x1035c3
#define GUEST_CONTEXT_SWITCH_ENTER 0x00105a2c
#define GUEST_CONTEXT_SWITCH_EXIT  0x105ad9
#define GUEST_SCHED_INIT_EXIT      0x105461
#define GUEST_SCHEDULER_LOCK       0x001393c8
#define GUEST_SCHEDULER_LOCKED(x)  (x)

#define GUEST_PANIC 0x0010b344
#define GUEST_KERNEL_MAIN 0x001010d4
#define GUEST_OUTB 0x0010b63f

#define GUEST_FORK_WINDOW_ENTER    0x103ef6
#define GUEST_THRFORK_WINDOW_ENTER 0x1041f1
#define GUEST_SLEEP_WINDOW_ENTER   0x103fe8
#define GUEST_VANISH_WINDOW_ENTER  0x104576
#define GUEST_FORK_RETURN_SPOT     0x001037ef
#define GUEST_READLINE_WINDOW_ENTER 0x00106fc5
#define GUEST_READLINE_WINDOW_EXIT 0x107241

#define GUEST_MUTEX_LOCK_ENTER   0x0010692c
#define GUEST_MUTEX_LOCK_MUTEX_ARGNUM 1
#define GUEST_MUTEX_BLOCKED      0x106953
#define GUEST_MUTEX_LOCK_EXIT    0x106969
#define GUEST_MUTEX_UNLOCK_ENTER 0x001069af
#define GUEST_MUTEX_UNLOCK_MUTEX_ARGNUM 1
#define GUEST_MUTEX_UNLOCK_EXIT  0x106a29

#define GUEST_LMM_ALLOC_ENTER      0x0010d0e0
#define GUEST_LMM_ALLOC_EXIT       0x10d38b
#define GUEST_LMM_ALLOC_SIZE_ARGNUM 2
#define GUEST_LMM_ALLOC_GEN_ENTER  0x0010990c
#define GUEST_LMM_ALLOC_GEN_EXIT   0x109cfa
#define GUEST_LMM_ALLOC_GEN_SIZE_ARGNUM 2
#define GUEST_LMM_FREE_ENTER       0x001094f0
#define GUEST_LMM_FREE_EXIT        0x1097c3
#define GUEST_LMM_FREE_BASE_ARGNUM 2
#define GUEST_LMM_FREE_SIZE_ARGNUM 3
#define GUEST_LMM_REMOVE_FREE_ENTER 0x001097d4
#define GUEST_LMM_REMOVE_FREE_EXIT 0x10990b

#define GUEST_IMG_END 0x0015942c
#define GUEST_DATA_START 0x00136000
#define GUEST_DATA_END 0x001370c0
#define GUEST_BSS_START 0x001370c0
#define GUEST_BSS_END GUEST_IMG_END

#define GUEST_SCHEDULER_FUNCTIONS { \
	{ 0x00105695, 0x1056d6 }, \
	{ 0x001056d7, 0x105756 }, \
	{ 0x00105757, 0x10592a }, \
	{ 0x0010592b, 0x105958 }, \
	{ 0x00105959, 0x105973 }, \
	{ 0x00105974, 0x105990 }, \
	{ 0x00105991, 0x1059b5 }, \
	{ 0x001059b6, 0x105a2b }, \
	{ 0x00105a2c, 0x105ad9 }, \
	{ 0x00106554, 0x106572 }, \
	{ 0x00103516, 0x1035b8 }, \
	}
#define GUEST_SCHEDULER_GLOBALS { \
	{ 0x001393c8, 4 }, \
	{ 0x00159400, 4 }, \
	{ 0x00137114, 4 }, \
	{ 0x001382f4, 16 }, \
	{ 0x001393e0, 16 }, \
	{ 0x00159404, 16 }, \
	}

#define GUEST_MUTEX_LOCK GUEST_MUTEX_LOCK_ENTER
#define GUEST_VANISH 0x00104223
#define GUEST_VANISH_END 0x104587
#define GUEST_MUTEX_IGNORES { \
	0x001370fc, \
	0x001382e8, \
	0x001370ec, \
	}

#endif
