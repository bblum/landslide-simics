performance
	language
		calling into python will suck - use C
		how fast would hasqel be? how easy?
	simics uses JIT for speed - how many orders of magnitude slowdown?

things to do
	learn simics C hooqs
	checkpoint 0: something that fires/prints on every guest instruction

stack
	./simics-model-builder-4.0.16/src/extensions/sample-memhier/sample-memhier.c
	snoop_memory interface probably the way to go
		note how to turn the STC off
	trace.c - trace_instr_operate

	to do next: debug trace and make sure the conf_object_t cast to a hax_t has the right hax_magic

to hook in hax:
	new-tracer
	@hax = SIM_create_object("hax", "hax0", [])
	# ...
	trace0.start
	@SIM_set_attribute(SIM_get_object("trace0"), "consumer", hax)
	# note: setting trace0.start resets the bt->trace_consume to text_tracer; set_consumer after that.

to make an interrupt stack frame:
	@cpu = SIM_get_object("cpu0")
	@SIM_set_attribute(cpu, "esp", cpu.esp - 12) # 3x 4B for eip, cs, eflags
	@SIM_write_phys_memory(cpu, cpu.esp + 0, cpu.eip, 4)
	@SIM_write_phys_memory(cpu, cpu.esp + 4, 16, 4) # KERNEL_SEGSEL_CS == 16
	@SIM_write_phys_memory(cpu, cpu.esp + 8, cpu.eflags, 4)
	@SIM_set_attribute(cpu, "eip", 0x001035bc)

	# note: this *might* be somehow broken...? i saw a triple fault *once*.
